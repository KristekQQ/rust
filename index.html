<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>WebGPU with Rust/WASM</title>
</head>
<body>
    <canvas id="gpu-canvas" width="640" height="480"></canvas>
    <script type="module">
        // Patch outdated WebGPU limit name for newer Chrome versions.
        const origRequestDevice = GPUAdapter.prototype.requestDevice;
        GPUAdapter.prototype.requestDevice = function(desc) {
            if (desc?.requiredLimits?.maxInterStageShaderComponents !== undefined &&
                desc.requiredLimits.maxInterStageShaderVariables === undefined) {
                desc.requiredLimits.maxInterStageShaderVariables =
                    desc.requiredLimits.maxInterStageShaderComponents;
                delete desc.requiredLimits.maxInterStageShaderComponents;
            }
            return origRequestDevice.call(this, desc);
        };

        import init from './pkg/webgpu_wasm.js';
        init();
    </script>
</body>
</html>
